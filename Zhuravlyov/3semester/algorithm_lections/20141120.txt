Мы в прошлый раз обсудили следующую теорему:
Если у нас есть некоторая игра из которой есть переходы в n игр, которые эквивалентны некоторым нимам *k1, ... *kn и есть переходы в игры, про которые мы ничего не знаем,
кроме того если i=mex(g(k1),...g(kn)), из каждой из игр, про которые мы ничего не знаем есть переходы в игры, эквивалентные *i.
Тогда игра эквивалентна *i.
Игра проирышна для первого игрока.
Если первый игрок ходит в k1,...kn, то мы отвечаем так, чтобы 2 нима были равны.
Если игрок делает другой переход, то сделаем переход в *i.
Значит игра эквивалентна ниму.

Утверждается, что если обходить вершины игры в каком угодно порядке (возможно, по несколько раз), применяя утверждение этой теоремы
и помечая тем самым известные нимы, мы пометим все игры, эквивалентные нимам.
Пусть это не так и какие-то нимы мы не пометили.
Рассмотрим в графе игру, которая эквивалентна ниму, такую, что выигрышная стратегия второго игрока занимает наименьшее число ходов. Пусть она эквивалентна *i.
У нас из этой игры есть 2 типа переходов: в нимы *j1,...*jk, и в игры B1,..Bn про которые мы ничего не знаем.
Рассматриваем игру: прямая сумма игры и *i. Она должна быть прогрышной. Придём же к противоречию.
i не лежит в множестве j1,...jk, иначе игра выигрышная.
Пусть есть x<i, не лежащий в j1...jk. Тогда первый игрок в *i сделает ход в *x.
Второй игрок не будет ходить в *j1,...*jk. Значит второй игрок ходит в некоторую неизвестную нам игру.
Но в A наименьшее число ходов до проигрыша. То есть (B1+*x) не может быть выигрышной.
То есть получили, что i = mex(j1,...jk).
Осталось показать, что из каждой игры B1,...Bn есть переход в *i.
Пусть есть игра B, из которой нет перехода в *i. Тогда ровно в эту игру первый игрок и ходит.
Но прямая сумма B и *i не может быть проигрышной по выбору A. Значит будем доказывать, что такая игра ничейная.
Если второй игрок ходит в нима, то он проиграет.
Тогда среди игр С1...Cn, про которые мы ничего не знаем, в которые есть переход из B, есть игра, из которой нет перехода в *i.
Нужно доказать, что туда-то ему и нужно пойти.
Ну в общем тут что-то муторное и непонятное, пока забьём(оставим в качестве упражнения).

Назовём игру INFk, если она представляет собой петлю, из которой есть переходы в множество нимов k.
Докажем, что игра INFk эквивалентна любой игре, из которой есть переходы в эти нимы и набор игр, про которые мы ничего не знаем.
Если мы рассматриваем прямую сумму с нимом, который есть в списке, то в обоих играх проигрыш.
Если мы рассматриваем прямую сумму с нимом, которого нет, то в INFk можно только стоять на месте.
А в обобщённой игре, чтобы не проиграть нужно ходить в игру, из которой нет перехода в соостветствующий ним.
Можно для доказательства этого применить пред. теорему.
Значит и там, и там, ничья.
Наконец, рассмотрим игру, не эквивалентную ниму.
Можно доказать, что прямая сумма двух игр, не эквивалентных ниму, всегда ничейная.

Утверждается, что если k1!=k2, то INFk1 и INFk2 неэквивалентны.
Пусть |k1|>=|k2|
Если g(INFk1+x)=1, то g(INFk2+x)=0.

Теперь все игры эквивалентны или нимам, или INFk.

Что мы теперь знаем про игры? 
= - эквивалентность
1) *i+*j = *(i^j)
2) INFk1 + INFk2 = INFempty - ничейная игра
3) INFk + *i = INFq, где q={k[i]^x, k[i] in k}

Нужно построить алгоритм, оценивающий для произвольного графа все вершины. Оценить его асимптотику.
Хотя бы за O(VE), не?